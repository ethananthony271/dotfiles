#!/usr/bin/env bash

currentCourseInfo=$CURRCOURSE/info.json

echoHelpMessage () {
  echo "currentCourseInfo - get information about the currently active course"
  echo
  echo "Using both the info.json file in each course directory as well as the"
  echo "file structure of the quarter directory, currentCourseInfo can be used"
  echo "to get information such as the title or directory or the current course"
  echo
  echo "Usage: currentCourseInfo [-t] [-s] [-c] [-n] [-d]"
  echo "  Each option will output the corresponding informationa about the"
  echo "  current course. Passing multiple options will output each value in"
  echo "  consecutive lines in order. No native formatting is supported."
  echo
  echo "Available Options:"
  echo "  -t                  Title of the course. From info.json"
  echo "  -s                  Short title of the course. From info.json"
  echo "  -c                  Four letter code of the course. From info.json"
  echo "  -n                  Number code of the course. From info.json"
  echo "  -d                  Hard directory of the course. From directory structure"
}

while getopts 'tscnd' opt; do
  case "$opt" in
    t)
      echo $(cat "$currentCourseInfo" | jq -r .title)
      ;;

    s)
      echo $(cat "$currentCourseInfo" | jq -r .short)
      ;;

    c)
      echo $(cat "$currentCourseInfo" | jq -r .code)
      ;;

    n)
      echo $(cat "$currentCourseInfo" | jq -r .number)
      ;;

    d)
      echo $(readlink -n $CURRCOURSE)
      ;;

    h)
      echoHelpMessage
      ;;

    ?)
      echo "Usage: $(basename $0) [-t] [-s] [-c] [-n] [-d]"
      echo
      echoHelpMessage
      exit 1
      ;;
  esac
done
